{"version":3,"file":"redirects.js","names":["redirects","Map","exists","newRedirect","fromPathRedirects","get","fromPath","some","redirect","_","isEqual","add","samePathRedirects","set","push","redirectsReducer","state","action","type","payload"],"sources":["../../../src/redux/reducers/redirects.ts"],"sourcesContent":["import _ from \"lodash\"\nimport { IGatsbyState, IRedirect, ICreateRedirectAction } from \"../types\"\n\nconst redirects = new Map<string, Array<IRedirect>>()\n\nfunction exists(newRedirect: IRedirect): boolean {\n  const fromPathRedirects = redirects.get(newRedirect.fromPath)\n\n  if (!fromPathRedirects) return false\n\n  return fromPathRedirects.some(redirect => _.isEqual(redirect, newRedirect))\n}\n\nfunction add(redirect: IRedirect): void {\n  let samePathRedirects = redirects.get(redirect.fromPath)\n\n  if (!samePathRedirects) {\n    samePathRedirects = []\n    redirects.set(redirect.fromPath, samePathRedirects)\n  }\n\n  samePathRedirects.push(redirect)\n}\n\nexport const redirectsReducer = (\n  state: IGatsbyState[\"redirects\"] = [],\n  action: ICreateRedirectAction\n): IGatsbyState[\"redirects\"] => {\n  switch (action.type) {\n    case `CREATE_REDIRECT`: {\n      const redirect = action.payload\n\n      // Add redirect only if it wasn't yet added to prevent duplicates\n      if (!exists(redirect)) {\n        add(redirect)\n\n        state.push(redirect)\n      }\n\n      return state\n    }\n\n    default:\n      return state\n  }\n}\n"],"mappings":";;;;;;;AAAA;;AAGA,MAAMA,SAAS,GAAG,IAAIC,GAAJ,EAAlB;;AAEA,SAASC,MAAT,CAAgBC,WAAhB,EAAiD;EAC/C,MAAMC,iBAAiB,GAAGJ,SAAS,CAACK,GAAV,CAAcF,WAAW,CAACG,QAA1B,CAA1B;EAEA,IAAI,CAACF,iBAAL,EAAwB,OAAO,KAAP;EAExB,OAAOA,iBAAiB,CAACG,IAAlB,CAAuBC,QAAQ,IAAIC,eAAA,CAAEC,OAAF,CAAUF,QAAV,EAAoBL,WAApB,CAAnC,CAAP;AACD;;AAED,SAASQ,GAAT,CAAaH,QAAb,EAAwC;EACtC,IAAII,iBAAiB,GAAGZ,SAAS,CAACK,GAAV,CAAcG,QAAQ,CAACF,QAAvB,CAAxB;;EAEA,IAAI,CAACM,iBAAL,EAAwB;IACtBA,iBAAiB,GAAG,EAApB;IACAZ,SAAS,CAACa,GAAV,CAAcL,QAAQ,CAACF,QAAvB,EAAiCM,iBAAjC;EACD;;EAEDA,iBAAiB,CAACE,IAAlB,CAAuBN,QAAvB;AACD;;AAEM,MAAMO,gBAAgB,GAAG,CAC9BC,KAAgC,GAAG,EADL,EAE9BC,MAF8B,KAGA;EAC9B,QAAQA,MAAM,CAACC,IAAf;IACE,KAAM,iBAAN;MAAwB;QACtB,MAAMV,QAAQ,GAAGS,MAAM,CAACE,OAAxB,CADsB,CAGtB;;QACA,IAAI,CAACjB,MAAM,CAACM,QAAD,CAAX,EAAuB;UACrBG,GAAG,CAACH,QAAD,CAAH;UAEAQ,KAAK,CAACF,IAAN,CAAWN,QAAX;QACD;;QAED,OAAOQ,KAAP;MACD;;IAED;MACE,OAAOA,KAAP;EAfJ;AAiBD,CArBM"}